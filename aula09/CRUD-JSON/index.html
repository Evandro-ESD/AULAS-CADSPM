<!DOCTYPE html>
<html lang="br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API local usando o json server</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <h2>Adicionar Post</h2>
    <ul id="postList"></ul>
    <input type="text" id="titulo" placeholder="Título">
    <input type="text" id="corpo" placeholder="Conteúdo">
    <button id="addBtn">Adicionar</button>

    <script>
        /* 
        comando usado para instalar o json server: npm install -g json-server
        comando usado para subir o json-server: json-server --watch db.json --port 8080 
        */
        const ul = document.getElementById('postList');
        const addBtn = document.getElementById('addBtn');
        //função para buscar posts
        function carregarPosts() {
            fetch('http://localhost:8080/posts')
                .then(response => response.json())
                .then(posts => {
                    ul.innerHTML = '';
                    posts.forEach(posts => {
                        const li = document.createElement('li');
                        li.innerHTML = ` <strong>${posts.title}</strong><br>${posts.body}`
                        ul.appendChild(li)
                    })
                })
        }
        carregarPosts();
        // função para adicinar no posts
        addBtn.addEventListener('click', () => {
            const title = document.getElementById('titulo').value
            const body = document.getElementById('corpo').value

            fetch('http://localhost:8080/posts', {
                method: 'POST',
                headers: {
                    'Content-type': 'aplication/json' /* info. ao servidor que é um formato json*/
                },
                body: JSON.stringify({ title, body }) /* o body será o conteúdo qeu seerá enviado a API */
            })
            .then(response => response.json())
            .then(data => {
                carregarPosts() /*Atualizar lista*/
                document.getElementById("title").value = ''
                document.getElementById("corpo").value = ''
            })
        })
    </script>

</body>

</html>